
{% if interfaces is defined and interfaces %}
interfaces {
    {% for interface in interfaces %}
    {{ interface.name }} {
        {% if interface.name.startswith('ge-') or 
                interface.name.startswith('xe-') or 
                interface.name.startswith('et-') or 
                interface.name.startswith('ae') %}
            {% if interface.bundle is not defined %}
                {% if interface.mtu is defined and interface.mtu %}
        mtu {{ interface.mtu }};
                {% else %}
        mtu 9216;
                {% endif %}
            {% endif %}
        {% endif %}
        {% if interface.description is defined and interface.description %}
        description "{{ interface.description }}";
        {% endif %}
        {% if interface.vrrp_gw is defined %}
        family inet {
            address {{ interface.ip_cidr }} {
                vrrp-group {{ interface.vrrp_group }} {
                    virtual-address {{ interface.vrrp_gw }};
                    accept-data;
                }
            }
        }
        {% elif interface.vni_gw is defined %}
        family inet {
            address {{ interface.ip_cidr}} {
                virtual-gateway-address {{ interface.vni_gw }};
                preferred;
            }
        }
        proxy-macip-advertisement;
        virtual-gateway-accept-data;
    {% elif interface.bundle is defined %}
        ether-options {
            802.3ad {{ interface.bundle }};
        }
    {% elif interface.trunk is defined %}
        unit 0 {
            family ethernet-switching {
            {% if interface.trunk %}
                interface-mode trunk;
            {% else %}
                interface-mode access;
            {% endif %}
                vlan {
                    {% set s = ' ' %}
                    members [ {{ s.join(interface.vlan) }} ];
                }
            }
        }
    {% elif interface.ip_cidr is defined and '.' in interface.name %}
        family inet {
            address {{ interface.ip_cidr }};
        }
    {% elif interface.ip_cidr is defined %}
        unit 0 {
            family inet {
                address {{ interface.ip_cidr }};
            }
        }
    {% endif %}
    }
    {% endfor %}
}
{% endif %}

